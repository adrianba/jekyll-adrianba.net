<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Using C# to access the Twitter API - adrianba.net</title>
<meta name="description" content="My last post described how to acquire Twitter OAuth keys and tokens to allow you to use Twitter’s API to access Twitter feeds. I showed how to use the request module with node.js, which has built-in support for OAuth, to request and process data.">


  <meta name="author" content="Adrian Bateman">
  
  <meta property="article:author" content="Adrian Bateman">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="adrianba.net">
<meta property="og:title" content="Using C# to access the Twitter API">
<meta property="og:url" content="https://adrianba.net/2014/05/20/using-c-to-access-the-twitter-api/">


  <meta property="og:description" content="My last post described how to acquire Twitter OAuth keys and tokens to allow you to use Twitter’s API to access Twitter feeds. I showed how to use the request module with node.js, which has built-in support for OAuth, to request and process data.">



  <meta property="og:image" content="http://adrianba.net/assets/sailing.jpg">



  <meta name="twitter:site" content="@adrianba">
  <meta name="twitter:title" content="Using C# to access the Twitter API">
  <meta name="twitter:description" content="My last post described how to acquire Twitter OAuth keys and tokens to allow you to use Twitter’s API to access Twitter feeds. I showed how to use the request module with node.js, which has built-in support for OAuth, to request and process data.">
  <meta name="twitter:url" content="https://adrianba.net/2014/05/20/using-c-to-access-the-twitter-api/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://adrianba.net/assets/sailing.jpg">
    
  

  
    <meta name="twitter:creator" content="@adrianba">
  



  <meta property="article:published_time" content="2014-05-20T00:00:00-07:00">



  <meta property="article:modified_time" content="2014-05-20T08:25:00-07:00">



  

  


<link rel="canonical" href="https://adrianba.net/2014/05/20/using-c-to-access-the-twitter-api/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Adrian Bateman",
      "url": "https://adrianba.net/",
      "sameAs": ["https://adebateman.org/","https://twitter.com/adrianba","https://facebook.com/adrianba","https://instagram.com/adebateman","https://www.linkedin.com/in/adrianba"]
    
  }
</script>


  <meta name="google-site-verification" content="BUqUy58DpivlHAgBj3S9R4nIrr4bSvVVWajoA7XED10" />


  <meta name="msvalidate.01" content="63DB9D179BA14FF88535CF66336C4ED2">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="adrianba.net Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          adrianba.net
          
        </a>
        <ul class="visible-links"></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/sailing.jpg" alt="Adrian Bateman" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Adrian Bateman</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Englishman in Seattle.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seattle, USA</span>
        </li>
      

      
        
          
            <li><a href="https://adebateman.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-globe" aria-hidden="true"></i><span class="label">Personal site</span></a></li>
          
        
      

      

      

      

      
        <li>
          <a href="https://twitter.com/adrianba" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span>
          </a>
        </li>
      

      

      
        <li>
          <a href="https://www.linkedin.com/in/adrianba" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span>
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/adrianba" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Using C# to access the Twitter API">
    <meta itemprop="description" content="My last post described how to acquire Twitter OAuth keys and tokens to allow you to use Twitter’s API to access Twitter feeds. I showed how to use the request module with node.js, which has built-in support for OAuth, to request and process data.">
    <meta itemprop="datePublished" content="2014-05-20T00:00:00-07:00">
    <meta itemprop="dateModified" content="2014-05-20T08:25:00-07:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Using C# to access the Twitter API
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>My last post described <a href="/2014/05/19/accessing-the-twitter-api-using-oauth">how to acquire Twitter OAuth keys and tokens</a> to allow you to use Twitter’s API to access Twitter feeds. I showed how to use the <a href="https://www.npmjs.org/package/request">request module</a> with node.js, which has built-in support for OAuth, to request and process data.</p>

<p>In this blog post I will show how to do the same thing using C# and .NET using the <a href="http://oauth.googlecode.com/svn/code/csharp/">OAuthBase class</a> linked to from <a href="http://oauth.net/code/">oauth.net</a>.</p>

<p>Let’s start with the code to call the Twitter API:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;span class="kwrd"&gt;using&lt;/span&gt; System;
&lt;span class="kwrd"&gt;using&lt;/span&gt; System.IO;
&lt;span class="kwrd"&gt;using&lt;/span&gt; System.Net;
&lt;span class="kwrd"&gt;using&lt;/span&gt; System.Text;
&lt;span class="kwrd"&gt;using&lt;/span&gt; OAuth;

&lt;span class="kwrd"&gt;class&lt;/span&gt; App {
    &lt;span class="kwrd"&gt;static&lt;/span&gt; &lt;span class="kwrd"&gt;void&lt;/span&gt; Main() {
        &lt;span class="rem"&gt;// URL for the API to call&lt;/span&gt;
        &lt;span class="kwrd"&gt;string&lt;/span&gt; url = &lt;span class="str"&gt;"https://api.twitter.com/1.1/statuses/user_timeline.json"&lt;/span&gt;
            + &lt;span class="str"&gt;"?screen_name=adrianba&amp;count=5"&lt;/span&gt;;

        &lt;span class="rem"&gt;// Create a http request for the API&lt;/span&gt;
        var webReq = (HttpWebRequest)WebRequest.Create(url);

        &lt;span class="rem"&gt;// Set the OAuth header&lt;/span&gt;
        var auth = &lt;span class="kwrd"&gt;new&lt;/span&gt; OAuthHeader();
        webReq.Headers.Add(&lt;span class="str"&gt;"Authorization"&lt;/span&gt;,auth.getHeader(url,&lt;span class="str"&gt;"GET"&lt;/span&gt;));

        &lt;span class="rem"&gt;// Echo the response to the console&lt;/span&gt;
        &lt;span class="kwrd"&gt;using&lt;/span&gt;(WebResponse webResp = webReq.GetResponse()) {
            &lt;span class="kwrd"&gt;using&lt;/span&gt;(StreamReader sr = &lt;span class="kwrd"&gt;new&lt;/span&gt; StreamReader(
                    webResp.GetResponseStream(),Encoding.GetEncoding(&lt;span class="str"&gt;"utf-8"&lt;/span&gt;)
                    )) {
                Console.WriteLine(sr.ReadToEnd());
            }
        }
    }    
}
</code></pre></div></div>

<p>The code here is similar to the previous <a href="/2014/05/19/accessing-the-twitter-api-using-oauth">post</a>. It creates a HTTP request to the API endpoint and this time simply writes the response to the console. The difference here is that we need to add the OAuth Authorization header. The magic takes place in the getHeader() method:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;span class="kwrd"&gt;class&lt;/span&gt; OAuthHeader : OAuthBase {
    &lt;span class="kwrd"&gt;public&lt;/span&gt; &lt;span class="kwrd"&gt;string&lt;/span&gt; getHeader(&lt;span class="kwrd"&gt;string&lt;/span&gt; url,&lt;span class="kwrd"&gt;string&lt;/span&gt; method) {
        &lt;span class="kwrd"&gt;string&lt;/span&gt; normalizedUri;
        &lt;span class="kwrd"&gt;string&lt;/span&gt; normalizedParameters;

        &lt;span class="rem"&gt;// OAuth keys - FILL IN YOUR VALUES HERE (see this &lt;a href="/2014/05/19/accessing-the-twitter-api-using-oauth"&gt;post&lt;/a&gt;)&lt;/span&gt;
        &lt;span class="kwrd"&gt;const&lt;/span&gt; &lt;span class="kwrd"&gt;string&lt;/span&gt; consumerKey = &lt;span class="str"&gt;"..."&lt;/span&gt;;
        &lt;span class="kwrd"&gt;const&lt;/span&gt; &lt;span class="kwrd"&gt;string&lt;/span&gt; consumerSecret = &lt;span class="str"&gt;"..."&lt;/span&gt;;
        &lt;span class="kwrd"&gt;const&lt;/span&gt; &lt;span class="kwrd"&gt;string&lt;/span&gt; token = &lt;span class="str"&gt;"..."&lt;/span&gt;;
        &lt;span class="kwrd"&gt;const&lt;/span&gt; &lt;span class="kwrd"&gt;string&lt;/span&gt; tokenSecret = &lt;span class="str"&gt;"..."&lt;/span&gt;;

        &lt;span class="rem"&gt;// Create timestamp and nonce for this request&lt;/span&gt;
        &lt;span class="kwrd"&gt;string&lt;/span&gt; timeStamp = GenerateTimeStamp();
        &lt;span class="kwrd"&gt;string&lt;/span&gt; nonce = GenerateNonce();

        &lt;span class="rem"&gt;// Generate signature for the header&lt;/span&gt;
        &lt;span class="kwrd"&gt;string&lt;/span&gt; signature = GenerateSignature(
            &lt;span class="kwrd"&gt;new&lt;/span&gt; Uri(url), consumerKey, consumerSecret, token, tokenSecret,
            method, timeStamp, nonce, &lt;span class="kwrd"&gt;out&lt;/span&gt; normalizedUri, &lt;span class="kwrd"&gt;out&lt;/span&gt; normalizedParameters);

        &lt;span class="rem"&gt;// Compose the authorization header value&lt;/span&gt;
        &lt;span class="rem"&gt;// See http://tools.ietf.org/html/rfc5849#section-3.5.1&lt;/span&gt;
        StringBuilder auth = &lt;span class="kwrd"&gt;new&lt;/span&gt; StringBuilder();
        auth.Append(&lt;span class="str"&gt;"OAuth "&lt;/span&gt;);
        auth.AppendFormat(&lt;span class="str"&gt;"{0}="{1}", "&lt;/span&gt;, OAuthConsumerKeyKey, UrlEncode(consumerKey));
        auth.AppendFormat(&lt;span class="str"&gt;"{0}="{1}", "&lt;/span&gt;, OAuthNonceKey, UrlEncode(nonce));
        auth.AppendFormat(&lt;span class="str"&gt;"{0}="{1}", "&lt;/span&gt;, OAuthSignatureKey, UrlEncode(signature));
        auth.AppendFormat(&lt;span class="str"&gt;"{0}="{1}", "&lt;/span&gt;, OAuthSignatureMethodKey, &lt;span class="str"&gt;"HMAC-SHA1"&lt;/span&gt;);
        auth.AppendFormat(&lt;span class="str"&gt;"{0}="{1}", "&lt;/span&gt;, OAuthTimestampKey, timeStamp);
        auth.AppendFormat(&lt;span class="str"&gt;"{0}="{1}", "&lt;/span&gt;, OAuthTokenKey, UrlEncode(token));
        auth.AppendFormat(&lt;span class="str"&gt;"{0}="{1}""&lt;/span&gt;, OAuthVersionKey, &lt;span class="str"&gt;"1.0"&lt;/span&gt;);
        &lt;span class="kwrd"&gt;return&lt;/span&gt; auth.ToString();    
    }
}
</code></pre></div></div>

<p>The OAuthHeader class inherits from the OAuthBase class mentioned above. This provides the GenerateTimeStamp, GenerateNonce, and GenerateSignature methods. <a href="https://dev.twitter.com/docs/auth/authorizing-request">Twitter uses the OAuth 1.0a protocol</a>, defined in <a href="http://tools.ietf.org/html/rfc5849">RFC5849</a>. This specification outlines the Authorization header value that is constructed at the end of the getHeader() method.</p>

<p>You can keep the OAuthHeader class around for easy access to resources needing OAuth authorization such as Twitter.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2014-05-20">May 20, 2014</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=adrianba&text=Using+C%23+to+access+the+Twitter+API%20https%3A%2F%2Fadrianba.net%2F2014%2F05%2F20%2Fusing-c-to-access-the-twitter-api%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fadrianba.net%2F2014%2F05%2F20%2Fusing-c-to-access-the-twitter-api%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fadrianba.net%2F2014%2F05%2F20%2Fusing-c-to-access-the-twitter-api%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2014/05/19/accessing-the-twitter-api-using-oauth/" class="pagination--pager" title="Accessing the Twitter API using OAuth
">Previous</a>
    
    
      <a href="/2015/03/12/itrsquos-time-to-move-on-from-ie8/" class="pagination--pager" title="It’s time to move on from IE8
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/11/23/surface-rt-recovery-and-updates/" rel="permalink">Clean recovery of Surface RT and Windows Update (2022)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">If you reset a Microsoft Surface RT from a recovery disk, there is a good chance
that you will get an error from Windows Update: Error 8007000e Windows Updat...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/05/13/running-ssh-agent-with-wsl2/" rel="permalink">Running ssh-agent with WSL2 (so that VSCode can find it)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I often use Visual Studio Code together with WSL2 using the Remote - WSL extension. Recently, I have been using Docker running on a remote server accessed ov...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/01/22/changing-windows-pc-name-case/" rel="permalink">Change Windows PC name to lower case
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">It is straightforward to change the name of your Windows PC through the Settings
app (go to System, About, and choose “Rename this PC”). One problem, though,...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2021/03/09/ubuntu-latest-git/" rel="permalink">Installing the latest version of git on Ubuntu
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="/privacy/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-mask" aria-hidden="true"></i> Privacy Policy</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Adrian Bateman. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZB7NPZFPYX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZB7NPZFPYX', { 'anonymize_ip': false});
</script>



<script
  async
  src="https://log.adrianba.net/script.js"
  data-website-id="e4a4e083-52be-40f7-88e9-3ac737346958"
></script>







  </body>
</html>
