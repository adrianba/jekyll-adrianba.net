language: ruby
rvm:
- current

sudo: false
dist: trusty

before_install:
- git clone --branch=publish https://github.com/adrianba/jekyll-adrianba.net.git ./_site

before_script:
 - chmod +x ./_deploy/cibuild.sh
 - chmod +x ./_deploy/deploy.sh

# Assume bundler is being used, therefore
# the `install` step will run `bundle install` by default.
script: ./_deploy/cibuild.sh

after_success:
 - 'if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then ./_deploy/deploy.sh; fi'

# branch whitelist
branches:
  only:
  - master

cache:
  bundler: true
  directories:
  - .cache

before_cache:
  mkdir -p .cache && cp .jekyll-metadata .cache

env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer
  - secure: "bguuPQWObgzhDyxXSZUtoH3oflyPMcQQ5NSPtkwZj97xfLgZYel8bQ+NSEHEwkpS/yjHtx38zl0kcm34mktOjXlEhRl83/dGT77Nfwr67i13aAi/SGGmHxzxzGG6PCGGc2d6hz0lfk1XEB06B1CByl7JmH7XIKLcgni4+3Y2Q5yH3VZe7XllgxxGAgpDrKHaP+CfTtXsoSdy+gMAS2JcnxP+zgllz8h7uyGBwbMWq8a0kA4PfGXI9eqIGa66BLEK0H+zARb7DouC7a41MFb4a2udUXYzWNtjGwGs7Rs/wSB4cF4WoS2Zlk3jNhc1oCS6K8cjDekEElqoPmI7Xma+a3IdDMkQdC7mr6fuvjLTfjzvl9JXyMR14fk0cjfkj/JcWh9S7JTDfNbS94nZ0KQ7xXoKe3nrbJSU3rRkTTDncN1qc03yILO3OAX71Lvv8NstaLufBjg5YFkxEXglxse8ae7xDXyDLiZv0++pmCcwzhnhOGixNUWj4eFB/H6qnRqjmimWw7lbhGB3IT4JJCxcIwxP3Uo25186yxC/d++fmzCZ/Fr9DUmmVK4tmKP58CVn4UeLkCmHNGiiOEFp2Zxuise5YsWSUVruqUgq50L6+YIH6wKmpA1Pl+j5dlbf3SrxX95+yzkWEx4/xjBKl5FMSTTfRB2X0S35P11Il1Sw0Bg="
