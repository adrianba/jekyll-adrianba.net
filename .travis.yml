language: ruby
rvm:
- 2.5

sudo: false
dist: trusty

before_install:
- git clone --branch=publish https://github.com/adrianba/jekyll-adrianba.net.git ./_site

before_script:
 - chmod +x ./_deploy/cibuild.sh
 - chmod +x ./_deploy/deploy.sh

# Assume bundler is being used, therefore
# the `install` step will run `bundle install` by default.
script: ./_deploy/cibuild.sh

after_success:
 - 'if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then ./_deploy/deploy.sh; fi'

# branch whitelist
branches:
  only:
  - master

cache:
  bundler: true
  directories:
  - .cache

before_cache:
  mkdir -p .cache && cp .jekyll-metadata .cache

env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer
  - secure: "gKjYNxxd7NZ/CI0LsI2HlfpIlDjsEQPzs28F6taTUDVanVid8L5QzZHHC8adCv34R+8EElCS4gtd8wbQ39TYPnDof7cmtPEd1l2TLzdgh5XAkV/E8oQhCgpBTS5+HFNTwkH84ObRlAPmcBTEKMRJuah88OEldFK41li0a3dOs5QGYD8h6e8E28LKyrCYDGEwgV9+nXmVrvwNUTriV0bhEkyECsTbjx0ffKw1lB1O2M5lHhf8MWXFnwiGQfQGbcSUZiisJhf3iE0wIRK84iJ+Q/7UePDLYpgEUO8jdm+iPqVpn/1ne2bZbmUDmO2sW3qyr/hJqEGXTAOQEcbFYZ9p8/TwqmRTFXbU/QfAsGUIQ9gBAS7cQQgGlRpiQkxzi8Ni0e6RAJMNqDTgO3BLDoxeJFc9h00Foshd+5y7SAULEyE7uIdbiUzfVlHknR7RvwBgwKAdpBTDfyRC0gveiY8pEgOPV0ZI/tnWUGqzaa3qMVSUKOraaDs9GpWviUekrGPS+JO4r7DOAkcz5uh3SIy3bRTl6TpFZQCTT/bUXpoKIVKny5KCKnSW7ds2XLPeF/K/HH/aCzxqaNp3nxb+GP/LHDqrRT5zw4V+yePI3bgAjT7xveungiW1GX/5NlGx6xcyrQBlKn6s7MCtzd09e/OuqfcFm3SmVaa2S8V5/K+bMPE="