<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.17.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>VTCaster - VisionTech Limited - adrianba.net</title>
<meta name="description" content="Dynamically cast objects so that you can use custom interfaces in script.">


  <meta name="author" content="Adrian Bateman">


<meta property="og:type" content="website">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="adrianba.net">
<meta property="og:title" content="VTCaster - VisionTech Limited">
<meta property="og:url" content="https://adrianba.net/software/vtcaster/">




  <meta property="og:image" content="http://adrianba.net/assets/sailing.jpg">



  <meta name="twitter:site" content="@adrianba">
  <meta name="twitter:title" content="VTCaster - VisionTech Limited">
  <meta name="twitter:description" content="Dynamically cast objects so that you can use custom interfaces in script.">
  <meta name="twitter:url" content="https://adrianba.net/software/vtcaster/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://adrianba.net/assets/sailing.jpg">
    
  

  
    <meta name="twitter:creator" content="@adrianba">
  







  

  


<link rel="canonical" href="https://adrianba.net/software/vtcaster/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Adrian Bateman",
      "url": "https://adrianba.net/",
      "sameAs": ["https://adebateman.org/","https://twitter.com/adrianba","https://facebook.com/adrianba","https://instagram.com/adebateman","https://www.linkedin.com/in/adrianba"]
    
  }
</script>


  <meta name="google-site-verification" content="BUqUy58DpivlHAgBj3S9R4nIrr4bSvVVWajoA7XED10" />


  <meta name="msvalidate.01" content="63DB9D179BA14FF88535CF66336C4ED2">




<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="adrianba.net Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          adrianba.net
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="" ></a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="VTCaster - VisionTech Limited">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">VTCaster - VisionTech Limited
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="dynamically-cast-interfaces-in-script">Dynamically cast interfaces in script</h2>

<p>Recently someone asked in one of the VB newsgroups <em>“Can scripting code create a component interface that is part of a custom interface?”</em>.</p>

<p>My initial reaction was that no, you couldn’t do this because scripting uses the IDispatch interface and you can only have one on your component. However, Sanin Saracevic put me right and pointed out that scripting can automatically wrap custom interfaces for you if you provide a method in your class to give you the custom interface. He also suggested writing a C++ component to read the component type library and dynamically cast the object to the required interface. This is what VTCaster does.</p>

<p>Okay, so that sounds a bit complicated; here’s an example to help you see how it works.</p>

<p>Suppose I create a class file (<em>MyIface.cls</em>) in VB to define an interface I want to implement (note that there is no function body - this is just the interface):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Option Explicit  
Public Function MyTest() As String  
End Function
</code></pre></div></div>

<p>Now, I create another class (<em>Test.cls</em>), which will implement the <code class="highlighter-rouge">MyIface</code> interface (and also a Test() method).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Option Explicit  
Implements MyIface  

Public Function Test() As String  
    Test = "Test function"  
End Function  

Private Function MyIface_MyTest() As String  
    MyIface_MyTest = "Interface MyTest"  
End Function  
</code></pre></div></div>

<p>Now in my .VBS script file, or .ASP web page, I can use the following code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dim oTest,oIface,oCast,strTemp  

Set oTest = CreateObject("Project.Test")  
strTemp = oTest.Test ' strTemp now holds "Test function"  

Set oCast = CreateObject("VTCaster.DynCast")  
Set oIface = oCast.castToInterface(oTest,"_MyIface")  
strTemp = oIface.MyTest ' strTemp now holds "Interface MyTest"  
</code></pre></div></div>

<p>The <code class="highlighter-rouge">castToInterface</code> call allows you to pass an object, and the name of the required interface, and it returns this interface. VB usually prepends an underscore (_) to the beginning of interface names which is why the code above asks for the <code class="highlighter-rouge">"_MyIface"</code> interface). In ASP code, you would typically use <code class="highlighter-rouge">Server.CreateObject</code> rather than simply <code class="highlighter-rouge">CreateObject</code>.</p>

<p>You can <a href="/software/download/VTCaster.zip">download the source code</a> for VTCaster [43K]. The zip file also includes a compiled DLL in case you don’t have access to Visual C++. Don’t forget to register the DLL with <code class="highlighter-rouge">regsvr32</code> before you try to use it.</p>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Adrian Bateman. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
