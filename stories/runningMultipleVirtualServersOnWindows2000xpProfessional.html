<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-gb">



<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<title>Running multiple virtual servers on Windows 2000/XP Professional</title>

<link rel="stylesheet" type="text/css" href="../style/style.css">
<meta name="revisit-after" content="1 days">
<meta name="robots" content="all">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss/rss.aspx">
</head>

<body>
<div id="branding"></div>
<div id="logo"><a href="../default.aspx">
	<img src="../style/logo.gif" width="178" height="76" border="0" alt="VisionTech"/></a></div>
<div id="menu">
	<!--webbot bot="Navigation" S-Type="sequence" S-Orientation="horizontal" S-Rendering="html" B-Include-Home="TRUE" B-Include-Up="FALSE" U-Page="sid:1001" S-Btn-Nml="&lt;A HREF=&quot;#URL#&quot; TARGET=&quot;#TARGET#&quot; CLASS=&quot;menu&quot;&gt;#LABEL#&lt;/A&gt;" S-Btn-Sel="#LABEL#" S-Btn-Sep="&amp;nbsp;&amp;nbsp;&amp;bull;&amp;nbsp;&amp;nbsp;" S-Bar="Dots" startspan --><!--webbot bot="Navigation" i-checksum="0" endspan -->
</div>

<div id="bodycontent">
<H1>Running multiple virtual servers on Windows 2000/XP Professional</H1>
<P>If you want often&nbsp;carry out development on&nbsp;more than one web site at a time, then you've probably come across the restriction in the Professional versions of Windows 2000 and Windows XP where you can only create a single virtual server. For a while, I've known that you could create more servers using ADSI and today I finally got around to putting together a generic script that does that.</P>
<P>Now, you can still only have one virtual server running at any one time, but being able to stop the current one and start a new one is useful, for me at any rate.</P>
<P>Here is the VBScript that creates a new virtual server:</P><PRE>Option Explicit
Dim oWeb,oSite,oRoot,nSiteID
Const POOLED = 2
Set oWeb = GetObject("IIS://LocalHost/W3SVC")
' Find next ID for new server and stop current servers
nSiteID = 0
For Each oSite In oWeb
 If oSite.Class="IIsWebServer" Then
  If IsNumeric(oSite.Name) Then
   If CLng(oSite.Name)&gt;nSiteID Then _
    nSiteID = CLng(oSite.Name)
  End If
  oSite.Stop
 End If
Next
nSiteID = nSiteID + 1
' Create new server
Set oSite = oWeb.Create("IIsWebServer",CStr(nSiteID))
oSite.ServerComment = "Web Site " &amp; CStr(nSiteID)
oSite.DefaultDoc = "default.htm,default.asp"
oSite.ServerBindings = ":80:"
oSite.ServerAutoStart = 0
oSite.SetInfo
' Create root
Set oRoot = oSite.Create("IIsWebVirtualDir","ROOT")
oRoot.Path = "C:\Inetpub\wwwroot"
oRoot.AccessRead = True
oRoot.SetInfo
oRoot.AppCreate2 POOLED
oRoot.AppEnable
oRoot.AppFriendlyName = "Default Application"
oRoot.SetInfo
oSite.Start</PRE>
<P>I'm hoping others might find this useful too.</P>
	</div>

<div id="leftcontent">&nbsp;</div>

</body>



</html>