<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Custom configuration section handlers - adrianba.net</title>
<meta name="description" content="I read Keith Ballinger’s excellent Web Services: Architecture and Implementation with .NET a few months ago, and it gave a fascinating approach to using XML Serialization. Keith suggests that this was really misnamed and that the term XML Mapping would be more appropriate because it is not designed to serialize any CLR object to XML, but rather designed to map any XML onto some set of CLR objects. Once you take this view and start to get a handle on the various XML mapping code attributes, XML serialization suddenly becomes much more powerful.">


  <meta name="author" content="Adrian Bateman">
  
  <meta property="article:author" content="Adrian Bateman">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="adrianba.net">
<meta property="og:title" content="Custom configuration section handlers">
<meta property="og:url" content="https://adrianba.net/2003/08/31/c5af363240f045a7a3f82b43af7d1a52/">


  <meta property="og:description" content="I read Keith Ballinger’s excellent Web Services: Architecture and Implementation with .NET a few months ago, and it gave a fascinating approach to using XML Serialization. Keith suggests that this was really misnamed and that the term XML Mapping would be more appropriate because it is not designed to serialize any CLR object to XML, but rather designed to map any XML onto some set of CLR objects. Once you take this view and start to get a handle on the various XML mapping code attributes, XML serialization suddenly becomes much more powerful.">



  <meta property="og:image" content="http://adrianba.net/assets/sailing.jpg">



  <meta name="twitter:site" content="@adrianba">
  <meta name="twitter:title" content="Custom configuration section handlers">
  <meta name="twitter:description" content="I read Keith Ballinger’s excellent Web Services: Architecture and Implementation with .NET a few months ago, and it gave a fascinating approach to using XML Serialization. Keith suggests that this was really misnamed and that the term XML Mapping would be more appropriate because it is not designed to serialize any CLR object to XML, but rather designed to map any XML onto some set of CLR objects. Once you take this view and start to get a handle on the various XML mapping code attributes, XML serialization suddenly becomes much more powerful.">
  <meta name="twitter:url" content="https://adrianba.net/2003/08/31/c5af363240f045a7a3f82b43af7d1a52/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://adrianba.net/assets/sailing.jpg">
    
  

  
    <meta name="twitter:creator" content="@adrianba">
  



  <meta property="article:published_time" content="2003-08-31T00:00:00-07:00">



  <meta property="article:modified_time" content="2003-08-31T11:45:55-07:00">



  

  


<link rel="canonical" href="https://adrianba.net/2003/08/31/c5af363240f045a7a3f82b43af7d1a52/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Adrian Bateman",
      "url": "https://adrianba.net/",
      "sameAs": ["https://adebateman.org/","https://twitter.com/adrianba","https://facebook.com/adrianba","https://instagram.com/adebateman","https://www.linkedin.com/in/adrianba"]
    
  }
</script>


  <meta name="google-site-verification" content="BUqUy58DpivlHAgBj3S9R4nIrr4bSvVVWajoA7XED10" />


  <meta name="msvalidate.01" content="63DB9D179BA14FF88535CF66336C4ED2">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="adrianba.net Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          adrianba.net
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href=""></a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/sailing.jpg" alt="Adrian Bateman" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Adrian Bateman</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Englishman in Seattle.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seattle, USA</span>
        </li>
      

      
        
          
            <li><a href="https://adebateman.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-globe" aria-hidden="true"></i><span class="label">Personal site</span></a></li>
          
        
      

      

      

      

      
        <li>
          <a href="https://twitter.com/adrianba" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span>
          </a>
        </li>
      

      

      
        <li>
          <a href="https://www.linkedin.com/in/adrianba" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span>
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/adrianba" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Custom configuration section handlers">
    <meta itemprop="description" content="I read Keith Ballinger’sexcellentWebServices: Architecture and Implementation with .NET a fewmonths ago, and it gave a fascinating approach to using XMLSerialization. Keith suggests that this was really misnamed andthat the term XML Mapping would be more appropriate because it isnot designed to serialize any CLR object to XML, but ratherdesigned to map any XML onto some set of CLR objects. Once you takethis view and start to get a handle on the various XML mapping codeattributes, XML serialization suddenly becomes much morepowerful.">
    <meta itemprop="datePublished" content="2003-08-31T00:00:00-07:00">
    <meta itemprop="dateModified" content="2003-08-31T11:45:55-07:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Custom configuration section handlers
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>I read <a href="http://www.keithba.net/">Keith Ballinger</a>’s
excellent
<a href="http://www.amazon.co.uk/exec/obidos/ASIN/0321113594/">Web
Services: Architecture and Implementation with .NET</a> a few
months ago, and it gave a fascinating approach to using XML
Serialization. Keith suggests that this was really misnamed and
that the term XML Mapping would be more appropriate because it is
not designed to serialize any CLR object to XML, but rather
designed to map any XML onto some set of CLR objects. Once you take
this view and start to get a handle on the various XML mapping code
attributes, XML serialization suddenly becomes much more
powerful.</p>

<p>For this reason, many of the cases where I have used the DOM
(XmlDocument) or XPathDocument in the past, can now be defined
using a lot less code using XML Serialization. This also makes the
code much more accessible for people with limited XML knowledge to
use and extend in an intuitive manner. I’ve recently written a base
class for dealing with custom configuration sections using this
approach and thought I’d share it here.</p>

<p>There is an
<a href="http://msdn.microsoft.com/library/en-us/dnadvnet/html/vbnet04222003.asp">
excellent article</a> by Rockford Lhotka that explains what XML
configuration files are and what they’re used for so I won’t repeat
any of that here. In that article, Rockford demonstrates how to
write the code for a custom configuration section by writing a
class that implements the <code class="language-plaintext highlighter-rouge">IConfigurationSectionHandler</code>
interface. If you want several config sections in your application,
however, you end up writing a lot of code that is almost
identical.</p>

<p>By using a base class for the configuration section handler, we
can write a minimal amount of code describing simply what settings
we want in our handler. Here is an example configuration settings
class:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;font color="#0000FF"&gt;using&lt;/font&gt; System;
&lt;font color="#0000FF"&gt;using&lt;/font&gt; System.Xml.Serialization;

[CustomConfigHandler("myConfig",Group="sampleConfig")]
&lt;font color="#0000FF"&gt;public class&lt;/font&gt; MyConfig : BaseConfigHandler
{
    [XmlAttribute("myString")]
    &lt;font color="#0000FF"&gt;public string&lt;/font&gt; MyString;

    [XmlAttribute("myInt")]
    &lt;font color="#0000FF"&gt;public int&lt;/font&gt; MyInt;

    &lt;font color="#0000FF"&gt;public static&lt;/font&gt; MyConfig Current {
        &lt;font color="#0000FF"&gt;get&lt;/font&gt; { &lt;font color="#0000FF"&gt;return&lt;/font&gt; (MyConfig)GetCurrent(&lt;font color="#0000FF"&gt;typeof&lt;/font&gt;(MyConfig)); }
    }
}
</code></pre></div></div>

<p>This class will parse a configuration section that looks like
this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;sampleConfig&gt;
    &lt;myConfig myString="abc" myInt="123" /&gt;
&lt;/sampleConfig&gt;
</code></pre></div></div>

<p>The key points to take from this are that we use an attribute on
the class <code class="language-plaintext highlighter-rouge">CustomConfigHandler</code> to indicate the name of
the XML node (<code class="language-plaintext highlighter-rouge">myConfig</code>) and the group name
(<code class="language-plaintext highlighter-rouge">sampleConfig</code>) and then we use standard XML
Serialization attributes for the fields. This gives us strongly
typed access to our settings. To access a setting in code, we
simply refer to the Current property:
<code class="language-plaintext highlighter-rouge">MyConfig.Current.MyString</code>.</p>

<p>Finally, we need to indicate in the .config file, where the code
resides to process the custom handler. We do this by including a
pointer to the handler code at the top of the .config file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;configSections&gt;
    &lt;sectionGroup name="sampleConfig"&gt;
        &lt;section name="myConfig" type="MyConfig,ConfigTest" /&gt;
    &lt;/sectionGroup&gt;
&lt;/configSections&gt;
</code></pre></div></div>

<p>This indicates that the class is called MyConfig in the assembly
ConfigTest.</p>

<p>The code for the BaseConfigHandler is
<a href="/software/download/BaseConfigHandler.cs.html">
here</a> and you can
<a href="/software/download/ConfigTest.zip">
download a sample project</a> to try out the code.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2003-08-31">August 31, 2003</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=adrianba&text=Custom+configuration+section+handlers%20https%3A%2F%2Fadrianba.net%2F2003%2F08%2F31%2Fc5af363240f045a7a3f82b43af7d1a52%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fadrianba.net%2F2003%2F08%2F31%2Fc5af363240f045a7a3f82b43af7d1a52%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fadrianba.net%2F2003%2F08%2F31%2Fc5af363240f045a7a3f82b43af7d1a52%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2003/08/31/b253bcc25508482c9e0392db3386050d/" class="pagination--pager" title="Missing compiler features from VB.NET
">Previous</a>
    
    
      <a href="/2003/10/27/906e9d870f5b40d69aa453ea23dd88a4/" class="pagination--pager" title="California Dreaming
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2021/03/09/ubuntu-latest-git/" rel="permalink">Installing the latest version of git on Ubuntu
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2021/02/18/sd-card-disconnects-on-surface-pro/" rel="permalink">Repeated SD Card Disconnects on Surface Pro 5
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I have been using a 128GB Micro-SD card as additional storage on my Surface Pro
(both Surface Pro 4 and Surface Pro 5) for some years and regularly run into ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2020/12/19/windows10-startup-folder/" rel="permalink">Quick shortcut to launching the Start Menu Startup folder in Explorer
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Here is a quick way to get to the current user’s Startup folder in the Start
Menu in Windows 10. Once there, you can right-click, Create Shortcut to add a
pr...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2020/12/19/changing-computer-name-command-line/" rel="permalink">Changing Computer Name from the command line on Windows 10
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Here is a way to change your Windows computer’s name from the command line.
[Source: Password Recovery Blog]
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="/privacy/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-mask" aria-hidden="true"></i> Privacy Policy</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Adrian Bateman. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48621303-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>









  </body>
</html>
